<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LeÃ§on 7 â€” Servomoteur Â· iSkohm</title>
  <link rel="stylesheet" href="../style.css">
</head>
<body>

<div class="progress-bar"></div>

<nav>
  <a href="../index.html" class="nav-logo">
    <svg class="circuit-svg" viewBox="0 0 28 28" fill="none">
      <rect x="2" y="2" width="10" height="10" rx="2" stroke="#00b4d8" stroke-width="1.5"/>
      <rect x="16" y="2" width="10" height="10" rx="2" stroke="#39d353" stroke-width="1.5"/>
      <rect x="9" y="16" width="10" height="10" rx="2" stroke="#7c3aed" stroke-width="1.5"/>
      <line x1="12" y1="7" x2="16" y2="7" stroke="#00b4d8" stroke-width="1.5"/>
      <line x1="7" y1="12" x2="7" y2="19" stroke="#00b4d8" stroke-width="1.5"/>
      <line x1="7" y1="19" x2="9" y2="19" stroke="#00b4d8" stroke-width="1.5"/>
      <line x1="21" y1="12" x2="21" y2="19" stroke="#39d353" stroke-width="1.5"/>
      <line x1="19" y1="19" x2="21" y2="19" stroke="#39d353" stroke-width="1.5"/>
      <circle cx="7" cy="7" r="1.5" fill="#00b4d8"/>
      <circle cx="21" cy="7" r="1.5" fill="#39d353"/>
      <circle cx="14" cy="21" r="1.5" fill="#7c3aed"/>
    </svg>
    <span class="logo-text">iSkohm</span>
  </a>
  <ul class="nav-links">
    <li><a href="../index.html">Accueil</a></li>
    <li><a href="../niveau1.html" class="active">Niveau 1</a></li>
    <li><a href="../niveau2.html">Niveau 2</a></li>
    <li><a href="../competition.html">ğŸ† CompÃ©tition</a></li>
  </ul>
</nav>

<div class="lesson-layout">

  <div class="breadcrumb">
    <a href="../index.html">Accueil</a>
    <span class="sep">â€º</span>
    <a href="../niveau1.html">Niveau 1</a>
    <span class="sep">â€º</span>
    <span class="current">LeÃ§on 7 â€” Servomoteur</span>
  </div>

  <div class="lesson-header">
    <div class="lesson-emoji">âš™ï¸</div>
    <h1 class="lesson-title">
      Servomoteur
      <span class="badge badge-avance">AvancÃ©</span>
    </h1>
    <div class="niveau-badge">ğŸ”µ Niveau 1 Â· BBC micro:bit Â· LeÃ§on 7/8</div>
  </div>

  <div class="lesson-section">
    <h2>ğŸ¯ Objectifs</h2>
    <ul>
      <li>Comprendre ce qu'est un signal PWM (modulation de largeur d'impulsion)</li>
      <li>ContrÃ´ler un servomoteur avec la micro:bit</li>
      <li>Convertir un angle (0-180Â°) en valeur PWM</li>
      <li>CrÃ©er une classe Python pour encapsuler le code du servo</li>
      <li>CrÃ©er un mouvement lent et progressif avec <code>tourne_ralenti()</code></li>
    </ul>
  </div>

  <div class="lesson-section">
    <h2>ğŸ› ï¸ MatÃ©riel nÃ©cessaire</h2>
    <div class="material-grid">
      <span class="material-tag">ğŸ”² BBC micro:bit v2</span>
      <span class="material-tag">ğŸ”Œ CÃ¢ble USB</span>
      <span class="material-tag">âš™ï¸ Servomoteur (ex: SG90)</span>
      <span class="material-tag">ğŸ”‹ Alimentation 5V externe</span>
      <span class="material-tag">ğŸ”— Fils de connexion</span>
    </div>
    <div class="info-box warning" style="margin-top:1rem">
      <span class="icon">âš ï¸</span>
      <div>Le servomoteur a besoin d'une alimentation externe ! Branche le fil de signal sur <strong>pin0</strong> de la micro:bit, et alimente le servo en 5V sÃ©parÃ©ment (GND commun avec la micro:bit).</div>
    </div>
  </div>

  <div class="lesson-section">
    <h2>ğŸ“– Cours</h2>

    <h3>C'est quoi le PWM ?</h3>
    <p>PWM = <strong>Pulse Width Modulation</strong> (modulation de largeur d'impulsion). Le servo reÃ§oit des impulsions Ã©lectriques trÃ¨s rapides. La durÃ©e de chaque impulsion dÃ©termine la position du servo :</p>
    <ul>
      <li>Impulsion de <strong>1ms</strong> â†’ position 0Â°</li>
      <li>Impulsion de <strong>1.5ms</strong> â†’ position 90Â° (centre)</li>
      <li>Impulsion de <strong>2ms</strong> â†’ position 180Â°</li>
    </ul>
    <p>Ces impulsions se rÃ©pÃ¨tent 50 fois par seconde (50 Hz, donc pÃ©riode = 20ms).</p>

    <h3>Exemple 1 â€” ContrÃ´le direct PWM</h3>

    <div class="code-block">
      <div class="code-block-header">
        <div class="code-block-lang"><div class="lang-dot"></div>1.PWM.py</div>
        <button class="copy-btn">Copier</button>
      </div>
      <div class="code-content"><code class="python">from microbit import *


servo = pin0

servo.set_analog_period(20) # f = 50hz donc p = 20ms

# PWM  entre 26 et 128
servo.write_analog(26)
sleep(500)
servo.write_analog(56)
sleep(500)
servo.write_analog(126)
sleep(500)</code></div>
    </div>

    <p>La micro:bit utilise des valeurs de 0 Ã  1023 pour le PWM analogique. Pour un servo standard :</p>
    <ul>
      <li><strong>26</strong> â‰ˆ 0Â° (impulsion ~0.5ms)</li>
      <li><strong>77</strong> â‰ˆ 90Â° (impulsion ~1.5ms)</li>
      <li><strong>128</strong> â‰ˆ 180Â° (impulsion ~2.5ms)</li>
    </ul>

    <h3>Exemple 2 â€” Conversion angle â†’ PWM</h3>
    <p>Pour travailler avec des angles en degrÃ©s, on crÃ©e une fonction de conversion :</p>

    <div class="code-block">
      <div class="code-block-header">
        <div class="code-block-lang"><div class="lang-dot"></div>2.Angle.py</div>
        <button class="copy-btn">Copier</button>
      </div>
      <div class="code-content"><code class="python">from microbit import *


servo = pin0

servo.set_analog_period(20)

def servo_angle(pin, angle):
    # Fait un mapping d'angle (0-180) vers PWM  (26-128)
    pwm = int(26 + (angle / 180) * (128 - 26))
    pin.write_analog(pwm)


servo_angle(servo,0)
sleep(500)
servo_angle(servo,45)
sleep(500)
servo_angle(servo,90)
sleep(500)
servo_angle(servo,135)
sleep(500)
servo_angle(servo,180)
sleep(500)</code></div>
    </div>

    <p>La formule <code>26 + (angle / 180) * (128 - 26)</code> est un <strong>mapping linÃ©aire</strong> : elle fait correspondre proportionnellement les angles (0â†’180) aux valeurs PWM (26â†’128).</p>

    <h3>Exemple 3 â€” Classe Servo (programmation orientÃ©e objet)</h3>
    <p>Pour les projets complexes, on crÃ©e une <strong>classe</strong> qui encapsule tout le comportement du servo. Ce fichier se sauvegarde dans <code>Servo.py</code> et on l'importe dans <code>main.py</code> :</p>

    <div class="code-block">
      <div class="code-block-header">
        <div class="code-block-lang"><div class="lang-dot"></div>3.Class_Servo.py â€” fichier Servo.py</div>
        <button class="copy-btn">Copier</button>
      </div>
      <div class="code-content"><code class="python">##### dans un fichier Servo.py

from microbit import *


class Servo:
    def __init__(self, pin, periode = 20):
        self.pin = pin
        self.pin.set_analog_period(periode)
        
    def tourne(self, angle):
    # Fait un mapping d'angle (0-180) vers PWM  (26-128)
        pwm = int(26 + (angle / 180) * (128 - 26))
        self.pin.write_analog(pwm)</code></div>
    </div>

    <div class="code-block">
      <div class="code-block-header">
        <div class="code-block-lang"><div class="lang-dot"></div>3.Class_Servo.py â€” fichier main.py</div>
        <button class="copy-btn">Copier</button>
      </div>
      <div class="code-content"><code class="python">##### dans le fichier main.py
        
from microbit import *
from Servo import Servo



pince = Servo(pin0)



pince.tourne(0)
sleep(500)
pince.tourne(45)
sleep(500)
pince.tourne(90)
sleep(500)
pince.tourne(180)
sleep(500)</code></div>
    </div>

    <h3>Exemple 4 â€” Mouvement lent (tourne_ralenti)</h3>
    <p>La version avancÃ©e de la classe Servo permet un mouvement progressif et fluide :</p>

    <div class="code-block">
      <div class="code-block-header">
        <div class="code-block-lang"><div class="lang-dot"></div>4.Ralenti.py â€” mÃ©thode tourne_ralenti</div>
        <button class="copy-btn">Copier</button>
      </div>
      <div class="code-content"><code class="python">    def tourne_ralenti(self, angle_final, pas=1, delai=20):
        if self.angle < angle_final:
            # tourne a partir de self.angle vers to angle_final
            while self.angle <= angle_final:
                self.tourne(self.angle)
                self.angle += pas
                sleep(delai)
        else:
            # sens oppose
            while self.angle >= angle_final:
                self.tourne(self.angle)
                self.angle -= pas
                sleep(delai)</code></div>
    </div>

    <p>Cette mÃ©thode incrÃ©mente l'angle de <code>pas</code> degrÃ©s toutes les <code>delai</code> millisecondes, crÃ©ant un mouvement fluide.</p>
  </div>

  <div class="lesson-section">
    <h2>âœï¸ Exercices</h2>

    <div class="exercice-card">
      <div class="ex-num">Exercice 1</div>
      <h3>Bras contrÃ´lÃ© par boutons</h3>
      <p>Utilise la fonction <code>servo_angle()</code> pour contrÃ´ler un servo avec les boutons : A â†’ tourne de 10Â° vers la droite, B â†’ tourne de 10Â° vers la gauche. Garde une variable <code>angle_actuel</code> et assure-toi qu'il reste entre 0 et 180.</p>
    </div>

    <div class="exercice-card">
      <div class="ex-num">Exercice 2</div>
      <h3>Pince automatique</h3>
      <p>Programme une sÃ©quence automatique avec la classe Servo : ouvre (0Â°) â†’ attends 1s â†’ ferme progressivement jusqu'Ã  90Â° â†’ attends 2s â†’ ouvre complÃ¨tement (180Â°) â†’ recommence. Utilise <code>tourne_ralenti()</code>.</p>
    </div>

    <div class="exercice-card">
      <div class="ex-num">Exercice 3 â€” DÃ©fi</div>
      <h3>ContrÃ´le par inclinaison</h3>
      <p>ContrÃ´le le servo avec l'accÃ©lÃ©romÃ¨tre ! En inclinant la micro:bit Ã  gauche ou Ã  droite, le servo tourne dans la direction correspondante. Utilise <code>accelerometer.get_x()</code> qui retourne une valeur entre -1024 et +1024.</p>
    </div>
  </div>

  <div class="lesson-section">
    <div class="retenir-box">
      <h2>ğŸ§  Ã€ retenir</h2>
      <ul class="retenir-list">
        <li><strong>PWM</strong> â€” signal qui contrÃ´le les servomoteurs par la durÃ©e des impulsions</li>
        <li><strong>set_analog_period(20)</strong> â€” fixe la pÃ©riode Ã  20ms (50 Hz)</li>
        <li><strong>write_analog(valeur)</strong> â€” envoie le signal PWM (26 Ã  128 pour un servo)</li>
        <li>Formule : <code>pwm = 26 + (angle / 180) * (128 - 26)</code></li>
        <li><strong>class NomClasse:</strong> â€” dÃ©finit une classe (un modÃ¨le d'objet)</li>
        <li><strong>__init__</strong> â€” mÃ©thode exÃ©cutÃ©e Ã  la crÃ©ation d'un objet</li>
        <li><strong>self</strong> â€” rÃ©fÃ©rence Ã  l'objet lui-mÃªme dans la classe</li>
      </ul>
    </div>
  </div>

  <div class="lesson-nav">
    <a href="lecon-06.html">â† LeÃ§on 6 â€” Listes & Fonctions</a>
    <a href="lecon-08.html">LeÃ§on 8 â€” Radio â†’</a>
  </div>

</div>

<footer>
  <p><strong class="logo-text">iSkohm</strong> Robot Club Â· <a href="https://iskohm.com">iskohm.com</a></p>
</footer>

<script src="../app.js"></script>
</body>
</html>
